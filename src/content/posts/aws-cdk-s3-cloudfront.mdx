---
title: "app routerã§SSGã—ãŸã‚‚ã®ã‚’ã€s3ã¨cloudfrontã‚’ä½¿ã£ã¦ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³ã§ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹æ§‹æˆã‚’aws-cdkã§ä½œã‚‹"
emoji: "ğŸ“"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
tags:
  - "AWS"
  - "Next.js"
published: true
published_at: "2023-06-12 17:50"
---

# ã‚„ã‚ŠãŸã„ã“ã¨

- zenn ã«è¨˜äº‹ã‚’æ›¸ã„ãŸã¨ãã«è‡ªåˆ†ã®ãƒ–ãƒ­ã‚°ã«ã‚‚æŠ•ç¨¿ã—ãŸã„
- å‹‰å¼·ã®ãŸã‚ aws ã§ä½œã‚ŠãŸã„
- å‹‰å¼·ã®ãŸã‚ app router ã‚’ä½¿ã„ãŸã„
- ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³ã«ã—ãŸã„
- aws ãƒªã‚½ãƒ¼ã‚¹ã¯ aws-cdk ã§ä½œã‚ŠãŸã„

# ã§ããŸã‚‚ã®

ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«æ‰‹é † + å°‘ã— md ã®ã‚¹ã‚¿ã‚¤ãƒ«ã¨ã‹ã®èª¿æ•´ãªã©ã—ã¦ã„ã¾ã™

https://tatsumiyamamoto.com

ä»¥ä¸‹ã®ã‚ˆã†ãªæ„Ÿã˜ã«ãªã£ã¦ã„ã¾ã™

- zenn-cli ã‚’ä½¿ã£ã¦ github ãƒªãƒã‚¸ãƒˆãƒªã¨åŒæœŸ(push æ™‚ã«è‡ªå‹•æŠ•ç¨¿)
- git push æ™‚ã« codebuild ãŒèµ°ã£ã¦ s3 ã¸ãƒ‡ãƒ—ãƒ­ã‚¤(è‡ªåˆ†ã®ãƒ–ãƒ­ã‚°ã«ãƒ‡ãƒ—ãƒ­ã‚¤)

![æ§‹æˆå›³](/images/compressed-images/s3-cloudfront.png)

# æº–å‚™

```bash:æº–å‚™
mkdir zenn-next-s3-cloudfront
cd zenn-next-s3-cloudfront
git init

npx create-next-app --ts

# Need to install the following packages:
#   create-next-app
# Ok to proceed? (y) y
# âœ” What is your project named? â€¦ frontend
# âœ” Would you like to use ESLint with this project? â€¦ Yes
# âœ” Would you like to use Tailwind CSS with this project? â€¦ No
# âœ” Would you like to use `src/` directory with this project? â€¦ Yes
# âœ” Use App Router (recommended)? â€¦ Yes
# âœ” Would you like to customize the default import alias? â€¦ No

mkdir infra
cd infra
npx cdk init app --language typescript

tree -aL 1
.
â”œâ”€â”€ .git
â”œâ”€â”€ frontend
â””â”€â”€ infra

4 directories, 0 files
```

# app router ã§ SSG ã™ã‚‹

## zod ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash:zodã‚’å…¥ã‚Œã‚‹
npm i zod
```

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```bash:ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ
tree -aL 4

.
â””â”€â”€ app
    â”œâ”€â”€ _libs
    â”‚   â””â”€â”€ article.ts
    â”œâ”€â”€ articles
    â”‚   â””â”€â”€ [id]
    â”‚       â””â”€â”€ page.tsx
    â”œâ”€â”€ favicon.ico
    â”œâ”€â”€ layout.tsx
    â””â”€â”€ page.tsx

5 directories, 5 files
```

## ä½œã£ã¦ã„ã

```ts:_libs/article.ts
import { z } from "zod";

export const articleSchema = z.object({
  id: z.number(),
  userId: z.number(),
  title: z.string(),
  completed: z.boolean(),
});

export const articlesSchema = z.array(articleSchema);

export type Article = z.infer<typeof articleSchema>;
export type Articles = z.infer<typeof articlesSchema>;

export const getArticle = async (id: string): Promise<Article> => {
  try {
    const res = await fetch(
      `https://jsonplaceholder.typicode.com/todos/${encodeURIComponent(id)}`
    );
    const article = await res.json();

    return articleSchema.parse(article);
  } catch (err: unknown) {
    if (err instanceof z.ZodError) {
      throw new Error(
        `Invalid article data: ${err.errors.map((e) => e.message).join(", ")}`
      );
    }
    throw err;
  }
};

export const getArticles = async (): Promise<Articles> => {
  try {
    const res = await fetch("https://jsonplaceholder.typicode.com/todos");
    const articles = await res.json();

    return articlesSchema.parse(articles);
  } catch (err: unknown) {
    if (err instanceof z.ZodError) {
      throw new Error(
        `Invalid article data: ${err.errors.map((e) => e.message).join(", ")}`
      );
    }
    throw err;
  }
};


```

```tsx:page.tsx
import Link from "next/link";
import { getArticles } from "./_libs/article";

export default async function Home() {
  const articles = await getArticles();

  return (
    <main>
      {articles.map((article) => {
        return (
          <Link
            href={`/articles/${encodeURIComponent(article.id)}`}
            key={article.id}
          >
            <h2>{`${article.id} ${article.title}`}</h2>
          </Link>
        );
      })}
    </main>
  );
}

```

```tsx:articles/[id]/page.tsx
import { getArticle, getArticles } from "@/app/_libs/article";

export async function generateStaticParams() {
  const articles = await getArticles();

  const params = articles.map((article) => {
    return {
      id: article.id.toString(),
    };
  });

  return params;
}

export default async function Article({ params }: { params: { id: string } }) {
  const article = await getArticle(params.id);

  return (
    <div>
      <h1>Article {article.id}</h1>
      <p>{article.title}</p>
    </div>
  );
}

```

## npm scripts ã®è¨­å®š

app router ã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã§é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãŒã§ãã¾ã™

```js:next.config.js
/** @type {import('next').NextConfig} */
const nextConfig = {
  output: "export", // next buildæ™‚ã«outãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é™çš„ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ(ä»¥å‰ã®next exportã‚³ãƒãƒ³ãƒ‰)
};

module.exports = nextConfig;

```

```json:package.json
{
  "name": "frontend",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "npx serve@latest out", // 'output': 'export'ã‚’è¨­å®šã—ã¦ã„ã‚‹ã¨ãã¯ next start ã§ã¯ãªãã“ã¡ã‚‰ã‚’ä½¿ã†
    "lint": "next lint"
  },
  "dependencies": {
    "@types/node": "20.3.0",
    "@types/react": "18.2.11",
    "@types/react-dom": "18.2.4",
    "eslint": "8.42.0",
    "eslint-config-next": "13.4.5",
    "next": "13.4.5",
    "react": "18.2.0",
    "react-dom": "18.2.0",
    "typescript": "5.1.3",
    "zod": "^3.21.4"
  }
}

```

ä»¥ä¸Šã®ã‚ˆã†ã«è¨­å®šã—ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™

```bash:ãƒ“ãƒ«ãƒ‰ã—ã¦å‹•ä½œç¢ºèªã™ã‚‹
npm run build # next buildã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œ ./out é…ä¸‹ã«SSGã•ã‚Œã‚‹
npm start # http://localhost:3000 ã§ã‚µãƒ¼ãƒãƒ¼ãŒç«‹ã¡ä¸ŠãŒã‚‹
```

# aws-cdk ã§é™çš„ã‚µã‚¤ãƒˆãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã‚’ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³ã§ä½œã‚‹

## ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’å–å¾—ã—ã¦ãŠã

ä»¥ä¸‹ã®ã‚µã‚¤ãƒˆã¨ã‹ã‚’å‚è€ƒã« route53 ã§ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’å–å¾—ã—ã¾ã™ã€‚

https://chigusa-web.com/blog/route53-reg/

https://qiita.com/NaokiIshimura/items/89e104dd2d8dd950780e

## s3+cloudfront ã® stack ã‚’ä½œã‚‹

åŸºæœ¬çš„ã«ã¯ä»¥ä¸‹ã®è¨˜äº‹ã¨åŒã˜ã§ã™ãŒã€route53 ã¸ã® A ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ç™»éŒ²ã‚’è¿½åŠ ã§ã—ãŸã‚Šã—ã¾ã™ã€‚

https://tatsumiyamamoto.com/articles/26f8b7bfea6243

```ts:infra/lib/infra-stack.ts
import {
  App,
  CfnOutput,
  RemovalPolicy,
  Stack,
  StackProps,
  aws_cloudfront,
  aws_cloudfront_origins,
  aws_codebuild,
  aws_iam,
  aws_route53,
  aws_route53_targets,
  aws_s3,
  aws_s3_deployment,
} from "aws-cdk-lib";
import { Certificate } from "aws-cdk-lib/aws-certificatemanager";
import { IHostedZone } from "aws-cdk-lib/aws-route53";
import "dotenv/config";

type ZennS3CloudFrontProps = StackProps & {
  domainName: string;
  certificate: Certificate;
  publicHostedZone: IHostedZone;
};

const OWNER = process.env.GITHUB_OWNER ?? "";
const REPO = process.env.GITHUB_REPO ?? "";
const BRANCH = process.env.GITHUB_BRANCH ?? "";
const GOOGLE_SEARCH_CONSOLE_VERIFICATION =
  process.env.GOOGLE_SITE_VERIFICATION ?? "";

export class ZennS3CloudFrontStack extends Stack {
  constructor(scope: App, id: string, props: ZennS3CloudFrontProps) {
    super(scope, id, props);
    const { domainName, certificate, publicHostedZone } = props;

    // é™çš„ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ç”¨ã®ãƒã‚±ãƒƒãƒˆã‚’ä½œæˆ
    const bucket = new aws_s3.Bucket(this, "ZennStaticHostingBucket", {
      bucketName: "zenn-static-hosting-bucket",
      removalPolicy: RemovalPolicy.DESTROY, // destroyæ™‚ã«ãƒã‚±ãƒƒãƒˆã‚’å‰Šé™¤ã™ã‚‹
      autoDeleteObjects: true, // destroyæ™‚ã«ãƒã‚±ãƒƒãƒˆå†…ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚‚å‰Šé™¤ã™ã‚‹
    });

    // cloudfrontç”¨ã®originAccessIdentityã‚’ä½œæˆ
    const originAccessIdentity = new aws_cloudfront.OriginAccessIdentity(
      this,
      "ZennOriginAccessIdentity",
      {
        comment: "ZennBlogOriginAccessIdentity",
      }
    );

    // bucket policyã‚’ä½œæˆ
    const bucketPolicy = new aws_iam.PolicyStatement({
      actions: ["s3:GetObject"], // GetObjectã®ã¿è¨±å¯
      resources: [`${bucket.bucketArn}/*`], // ãƒã‚±ãƒƒãƒˆå†…ã®å…¨ã¦ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å¯¾è±¡
      // originAccessIdentityã‹ã‚‰(CloudFrontçµŒç”±ã§ã®ã‚¢ã‚¯ã‚»ã‚¹)ã®ã¿ã‚’è¨±å¯
      principals: [
        new aws_iam.CanonicalUserPrincipal(
          originAccessIdentity.cloudFrontOriginAccessIdentityS3CanonicalUserId
        ),
      ],
    });

    // bucketã«policyã‚’è¿½åŠ 
    bucket.addToResourcePolicy(bucketPolicy);

    // ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®èª¿æ•´ã‚’è¡Œã†
    const cloudFrontFuntion = new aws_cloudfront.Function(
      this,
      "CloudFrontFunction",
      {
        code: aws_cloudfront.FunctionCode.fromFile({
          filePath: "lib/cloudfront-function.js",
        }),
      }
    );

    const distribution = new aws_cloudfront.Distribution(
      this,
      "BlogDistribution",
      {
        comment: "ZennBlogDistribution",
        defaultRootObject: "index.html",
        defaultBehavior: {
          compress: true,
          viewerProtocolPolicy:
            aws_cloudfront.ViewerProtocolPolicy.REDIRECT_TO_HTTPS,
          allowedMethods: aws_cloudfront.AllowedMethods.ALLOW_GET_HEAD,
          origin: new aws_cloudfront_origins.S3Origin(bucket, {
            originAccessIdentity,
          }),
          functionAssociations: [
            {
              function: cloudFrontFuntion,
              eventType: aws_cloudfront.FunctionEventType.VIEWER_REQUEST,
            },
          ],
        },
        errorResponses: [
          {
            httpStatus: 404,
            responseHttpStatus: 404,
            responsePagePath: "/404.html",
          },
        ],
        certificate,
        domainNames: [domainName],
      }
    );

    // Aãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ
    new aws_route53.ARecord(this, "ZennBlogARecord", {
      recordName: domainName,
      zone: publicHostedZone,
      target: aws_route53.RecordTarget.fromAlias(
        new aws_route53_targets.CloudFrontTarget(distribution)
      ),
    });

    // Google Search Consoleç”¨ã®TXTãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ
    new aws_route53.TxtRecord(this, "ZennBlogGoogleSearchConsoleRecord", {
      recordName: domainName,
      zone: publicHostedZone,
      values: [
        `google-site-verification=${GOOGLE_SEARCH_CONSOLE_VERIFICATION}`,
      ],
    });

    // s3ã«ãƒ‡ãƒ—ãƒ­ã‚¤
    new aws_s3_deployment.BucketDeployment(this, "ZennBlogBucketDeployment", {
      destinationBucket: bucket,
      distribution,
      sources: [
        aws_s3_deployment.Source.data(
          "/index.html",
          "<html><body><h1>Hello, World!</h1></body></html>"
        ),
      ],
    });

    const buildSpec = {
      version: "0.2",
      phases: {
        pre_build: {
          commands: ["cd frontend && npm ci"],
        },
        build: {
          commands: ["npm run build"],
        },
        post_build: {
          commands: [
            "aws s3 sync ./out s3://(ãƒã‚±ãƒƒãƒˆå) --delete", // s3 cp ã§ã¯ãªã s3 syncã§ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã“ã¨ã§æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤ã‚‚è¡Œã†ã“ã¨ãŒã§ãã‚‹
          ],
        },
      },
    };

    // codebuildç”¨ã®roleã‚’ä½œæˆ
    const codebuildRole = new aws_iam.Role(this, "CodeBuildRole", {
      roleName: "ZennBlogCodeBuildRole",
      assumedBy: new aws_iam.ServicePrincipal("codebuild.amazonaws.com"),
    });

    // s3ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’è¿½åŠ 
    codebuildRole.addManagedPolicy(
      aws_iam.ManagedPolicy.fromAwsManagedPolicyName("AmazonS3FullAccess")
    );

    const codebuild = new aws_codebuild.Project(this, "CodeBuild", {
      projectName: "ZennBlogCodeBuild",
      source: aws_codebuild.Source.gitHub({
        owner: OWNER,
        repo: REPO,
        branchOrRef: BRANCH,
        webhook: true,
      }),
      environment: {
        privileged: true,
        buildImage: aws_codebuild.LinuxBuildImage.STANDARD_7_0,
      },
      buildSpec: aws_codebuild.BuildSpec.fromObject(buildSpec),
      role: codebuildRole,
      cache: aws_codebuild.Cache.bucket(bucket),
    });

    new CfnOutput(this, "URL", {
      value: `https://${domainName}`,
    });
  }
}

```

```js:lib/cloudfront-function.js
// cloudfront functionã¯ES6ä»¥å‰ã®è¨˜æ³•ã§æ›¸ãå¿…è¦ãŒã‚ã‚‹
// ã‚¢ãƒ­ãƒ¼é–¢æ•°, let, constãªã©ã¯ä½¿ãˆãªã„
function handler(event) {
  var request = event.request;
  var uri = request.uri;

  // '/'ã®å ´åˆã¯index.htmlã‚’è¿”ã™
  if (uri === "/") return request;

  var filename = uri.split("/").pop();

  if (!filename) {
    return {
      status: "302",
      statusDescription: "Found",
      headers: {
        location: [
          {
            key: "Location",
            value: uri.replace(/\/+$/, "") || "/",
          },
        ],
      },
    };
  } else if (!filename.includes(".")) {
    request.uri = uri.concat(".html");
  }

  return request;
}

```

## cloudfront ç”¨ã®è¨¼æ˜æ›¸ã‚’ us-east-1 ã§å–ã‚‹å¿…è¦ãŒã‚ã‚‹

cloudfront ç”¨ã®è¨¼æ˜æ›¸ã¯ us-east-1 ã§å–ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

https://tmokmss.hatenablog.com/entry/20230130/1675040258

aws-cdk ã§ã¯åŒã˜ app construct ã§åˆ¥ã® region ã® stack ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™

https://dev.classmethod.jp/articles/aws-cdk-to-see-if-stacks-in-different-regions-can-be-deployed-in-the-same-app-construct/

ã“ã‚Œã‚’ç”¨ã„ã¦ã€

1. us-east-1 ã§è¨¼æ˜æ›¸ã‚’å–å¾—
2. ap-northeast-1 ãªã©ã®åˆ¥ãƒªãƒ¼ã‚¸ãƒ§ãƒ³(s3 + cloudfront ã‚’ç«‹ã¦ãŸã„ãƒªãƒ¼ã‚¸ãƒ§ãƒ³)ã§è¨¼æ˜æ›¸ã‚’ä½¿ã†

ã¨ã„ã†æ–¹æ³•ã§ã„ãã¾ã™ã€‚

```ts:infra/lib/us-east-1-stack.ts
import {
  App,
  Stack,
  StackProps,
  aws_certificatemanager,
  aws_route53,
} from "aws-cdk-lib";
import { Certificate } from "aws-cdk-lib/aws-certificatemanager";
import { IHostedZone } from "aws-cdk-lib/aws-route53";

type ZennUsEast1StackProps = StackProps & {
  domainName: string;
};

export class ZennUsEast1Stack extends Stack {
  public readonly publicHostedZone: IHostedZone;
  public readonly certificate: Certificate;

  constructor(scope: App, id: string, props: ZennUsEast1StackProps) {
    super(scope, id, props);

    const { domainName } = props;

    // ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ã‚’ä½œæˆ
    const publicHostedZone = aws_route53.HostedZone.fromLookup(
      this,
      "ZennHostedZone",
      {
        domainName,
      }
    );

    // cloudfrontã‚ˆã†ã«è¨¼æ˜æ›¸ã‚’ä½œæˆ(cloudfrontã®åˆ¶ç´„ã§us-east-1ã§ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹)
    const certificate = new aws_certificatemanager.Certificate(
      this,
      "ZennCertificate",
      {
        domainName,
        certificateName: "ZennCertificate",
        validation:
          aws_certificatemanager.CertificateValidation.fromDns(
            publicHostedZone
          ),
      }
    );

    this.certificate = certificate;
    this.publicHostedZone = publicHostedZone;
  }
}

```

## ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®èª¿æ•´ã‚’ cloudfront function ã§è¡Œã†

ãã®ã¾ã¾ã®è¨­å®šã ã¨ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãŒã†ã¾ãã„ã‹ãªã„ã®ã§ã€lambda@edge ã¾ãŸã¯ cloudfront function ã‚’ä½¿ã£ã¦èª¿æ•´ã‚’ã—ã¾ã™ã€‚
cloudfront function ã¯å¤ã„ JS ã®è¨˜æ³•ã—ã‹ä½¿ãˆãªã‹ã£ãŸã‚Šå®¹é‡åˆ¶é™ãŒã‚ã‚Šã¾ã™ãŒã€lambda@edge ã«æ¯”ã¹ã¦å®‰ã„ã¿ãŸã„ã§ã™ã€‚

https://qiita.com/shinnoki/items/9cf68e68cbe594732b4b

## ã‚¯ãƒ­ã‚¹ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ãª stack ã®ãƒ‡ãƒ—ãƒ­ã‚¤

ä¸Šã§ä½œæˆã—ãŸäºŒã¤ã® stack ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚stack ã‚’ä½œæˆã™ã‚‹éš›ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®å¼•æ•°ã¨ã—ã¦ã€ä½œæˆå…ˆã® region ã¨ã€`crossRegionReferences: true`ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã‚¯ãƒ­ã‚¹ãƒªãƒ¼ã‚¸ãƒ§ãƒ³å‚ç…§ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```ts:infra/bin/infra.ts
#!/usr/bin/env node
import "source-map-support/register";
import * as cdk from "aws-cdk-lib";
import { ZennUsEast1Stack } from "../lib/us-east-1-stack";
import { ZennS3CloudFrontStack } from "../lib/infra-stack";

const app = new cdk.App();

const domainName = 'ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³(ä¾‹.https://google.com)'

const usEast1 = new ZennUsEast1Stack(app, "UsEast1Stack", {
  env: {
    account: 'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆID'
    region: "us-east-1",
  },
  crossRegionReferences: true, // ã‚¯ãƒ­ã‚¹ãƒªãƒ¼ã‚¸ãƒ§ãƒ³å‚ç…§ã‚’ON
  domainName,
});

new ZennS3CloudFrontStack(app, "ZennS3CloudFrontStack", {
  env: {
    account: 'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆID'
    region: 's3 + cloudfrontã‚’ä½œæˆã—ãŸã„å…ˆã®region(ä¾‹. ap-northeast-1)'
  },
  crossRegionReferences: true, // ã‚¯ãƒ­ã‚¹ãƒªãƒ¼ã‚¸ãƒ§ãƒ³å‚ç…§ã‚’ON
  domainName,
  // usEast1ã‚¹ã‚¿ãƒƒã‚¯ã‹ã‚‰ã®å‚ç…§
  certificate: usEast1.certificate,
  publicHostedZone: usEast1.publicHostedZone,
});
```

# ãƒ‡ãƒ—ãƒ­ã‚¤

```bash:é–¢é€£ã™ã‚‹Stackã‚’ã™ã¹ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹
npx cdk deploy --all
```

# ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸãƒªã‚½ãƒ¼ã‚¹ã®å‰Šé™¤

```bash:ãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ã™ã‚‹
npx cdk destroy
```
